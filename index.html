<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="/main.css" >
    <title>Weather App</title>
  <body>
		<div id="widget">
			<canvas id="illustration"></canvas>
			<div id="information">
				<div id="city"></div>
				<div>
					<div id="temp"></div>
					<div id="humidity"></div>
					<div id="weather"></div>
					<div id="weatherDes"></div>
					<div></div>
				</div>
			</div>
		</div>
  </body>
  <script src="/socket.io/socket.io.js"></script>
	<script>
		const socket = io();

		function readInfo (json) {
			const city = json.name; 
			const temp = json.main.temp;
			const weather = json.weather[0].main;
			const weatherDes = json.weather[0].description;
			const humidity = json.main.humidity;

			document.getElementById("city").innerHTML = city;
			document.getElementById("temp").innerHTML = temp + 'Â°';
			document.getElementById("humidity").innerHTML = humidity + '%';
			document.getElementById("weather").innerHTML = weather;
			document.getElementById("weatherDes").innerHTML = weatherDes;
		}

		function drawCanvas (){
			const canvas = document.getElementById("illustration");
			canvas.width = 400;
			canvas.height = 400;
			const ctx = canvas.getContext("2d");
			// console.log (ctx);


			//background
			ctx.fillStyle = '#48b4e0';
			ctx.fillRect(0, 0, canvas.width, canvas.height);

			//hills
			ctx.fillStyle = "#503760";
			ctx.beginPath()
			ctx.arc(120, 360, 140, 0, Math.PI, true);
			ctx.arc(300, 350, 145, 0, Math.PI, true);
			ctx.fill();	
			ctx.fillStyle = "#8ED6FF";
			ctx.beginPath()
			ctx.arc(40, 400, 120, 0, Math.PI, true);
			ctx.arc(200, 400, 130, 0, Math.PI, true);
			ctx.arc(350, 400, 120, 0, Math.PI, true);
			ctx.fill();

			//sun
			ctx.fillStyle = "#503760";
			ctx.beginPath()
			ctx.arc(80, 80, 40, 0, 2 * Math.PI, true);
			ctx.fill();

			//cloud
			const cloudPos = [ [200, 90], [120, 100], [300, 100]]
			for (const pos of cloudPos) {
				ctx.beginPath();
				ctx.arc(pos[0], pos[1], 30, Math.PI * 0.5, Math.PI * 1.5);
				ctx.arc(pos[0] + 35, pos[1] - 30, 35, Math.PI * 1, Math.PI * 1.85);
				ctx.arc(pos[0] + 76, pos[1] - 22, 25, Math.PI * 1.37, Math.PI * 1.91);
				ctx.arc(pos[0] + 100, pos[1], 30, Math.PI * 1.5, Math.PI * 0.5);
				ctx.moveTo(pos[0] + 100, pos[1] + 30);
				ctx.lineTo(pos[0], pos[1] + 30);
				ctx.fillStyle = '#8ED6FF';
				ctx.fill()
			}

		}
		
		socket.on('weather info', function(json) {
			readInfo(json);
			drawCanvas()
		});

	</script>	
</html>